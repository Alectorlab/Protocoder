<!DOCTYPE html>

<html>
<head>
    <title>MAKEwithMOTO</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta http-equiv="editor-type">

    <!-- styles -->
    <link rel="stylesheet" href="./libs/w2ui-1.2/w2ui-1.2.css" type="text/css" charset="utf-8"/>

    <link rel="stylesheet/less" type="text/less" href="./css/style.less" />
    <link rel="stylesheet/less" type="text/less" href="./css/plots.less" />
    <link rel="stylesheet/less" type="text/less" href="./css/help.less" />


    <!-- libs --> 
    <script src="./libs/ace/ace.js" type="text/javascript" charset="utf-8"></script>
   <!-- <script src="./libs/require.js"></script> --> 
    <script src="./libs/less-1.4.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="./libs/dat.gui.min.js"></script> 
    <script type="text/javascript" src="./libs/jquery-1.10.2.min.js"></script> 
    <script type="text/javascript" src="./libs/jquery-ui-1.10/js/jquery-ui-1.10.3.custom.js"></script>
    <script src="./libs/d3.v3/d3.v3.js"></script>
    <!-- Including the HTML5 Uploader plugin -->
    <script src="./libs/jquery.filedrop.js"></script>
    <script src="./libs/w2ui-1.2/w2ui-1.2.js" type="text/javascript" charset="utf-8"></script>


     <!-- custom --> 
    <script src="./js/project.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/help.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/plots.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/android_communication.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/websockets.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/upload.js" type="text/javascript" charset="utf-8"></script>


<script type="text/javascript">
	
//test 
$(document).ready(function() {
var pstyle = 'border: 0px solid #dfdfdf; padding: 0px;';

$('#toolbar').w2toolbar({
        name: 'toolbar',
        items: [
            { type: 'button',  id: 'project_new', caption: 'New Project', img: 'icon-page' },
            { type: 'break',  id: 'break0' },
            { type: 'button',  id: 'project_save', caption: 'Save', img: 'icon-save'},
            
            { type: 'menu',   id: 'list_projects', caption: 'Projects', img: 'icon-folder', items: [
          
            ]},

            { type: 'menu',   id: 'list_examples', caption: 'Examples', img: 'icon-folder', items: [
           
            ]},

            
            { type: 'break', id: 'break1' },
            { type: 'button',  id: 'project_run',  caption: 'Run', img: 'icon-run', hint: 'Run project' },

            { type: 'spacer' }

        ],
        onClick: function (target, data) {
            //this.owner.content('main', target);
            //console.log(data);
            
            switch(target) { 
            case 'project_new':
                    openPopup();
                    break;
            case 'project_run':
                if (currentProject.name != 'undefined') { 

                    currentProject.code = session.getValue();
                    push_code(currentProject);
                    removeWidgets();
                    run_app(currentProject);
                } else { 
                    openPopup();
                }
                
                break;
                
            case 'project_save':
                if (currentProject.length != 'undefined') { 

                    currentProject.code = session.getValue();
                    push_code(currentProject);
                } else { 
                    openPopup();
                    
                }

                break;
           case 'list_projects':
                if (data.subItem != 'undefined') { 
                    fetch_code(data.subItem, target);
                }
                break;
            case 'list_examples':
                if (data.subItem != 'undefined') { 
                    fetch_code(data.subItem, target);  
                }
                break;
            case 'dashboard':
                    break;
            default: break;
        }
        }
            
});

$('#layout').w2layout({
    name: 'layout',
    panels: [
        { type: 'main', style: pstyle, content: 'main' },
        { type: 'right', size: 400, style: pstyle, content: 'right', resizable: true }

    ]
});


$().w2layout({
    name: 'code_editor',
    panels: [
       { type: 'main', style: pstyle, content: 'main', tabs: {
            active: 'tab1',
            name: 'tabs',
            tabs: [
                { id: 'tab1', caption: 'Code' },
            ],
            onClick: function (target, data) {
            
                //this.owner.content('main', target);
            }
        } },
        { type: 'bottom', size: "100px", resizable: true, hidden: false, style: pstyle, content: '<div id = "console"></div>' }
    ]
});

$().w2layout({
    name: 'right_bar',
    panels: [
        { type: 'main', size: '70%', resizable: true, style: pstyle, content: '<div id = "reference_container" style="background:#dfdfdf"> <div id = "reference"><h1 style="color:#777777; font-size:1.25em; font-style:normal; font-weight:500; text-shadow: 2px 2px #eeeeee; vertical-align:middle;">REFERENCE</h1></div> </div>' },
        { type: 'bottom', size: '30%', resizable: true, hidden: false, style: pstyle, content: 'bottom' }
    ]
});

var gridRendered = false; 
$('#grid').w2grid({ 
    name: 'grid', 
    url: '',
    onRender: function() { 
        gridRendered = true;
      // $("#grid_grid_records").append('<div id = "dropbox"> </div>');
    },
    columns: [              
        { field: 'file_name', caption: 'File Name', size: '70%', editable: {type:'text'} },
        { field: 'file_size', caption: 'File Size', size: '30%' },
    ]
});


w2ui['right_bar'].content('bottom', w2ui['grid']);
w2ui['layout'].content('main', w2ui['code_editor']);
w2ui['layout'].content('right', w2ui['right_bar']);
w2ui['code_editor'].content('main', '<pre id="editor"></pre>');

function openPopup () {
    $().w2form({
        name: 'foo',
        style: 'border: 0px; background-color: transparent;',
        formHTML: 
            '<div class="w2ui-page page-0">'+
            '   <div class="w2ui-label"> Name:</div>'+
            '   <div class="w2ui-field">'+
            '       <input name="project_name" type="text" size="35"/>'+
            '   </div>'+
            '</div>'+
            '<div class="w2ui-buttons">'+
            '   <input type="button" value="OK" name="save">'+
            '   <input type="button" value="Cancel" name="cancel">'+
            '</div>',
        fields: [
            { name: 'project_name', type: 'text', required: true },
        ],
        record: { 
            first_name  : ':)',
        },
        actions: {
            "save": function () { 
                create_new_project( $("input#project_name").val() );
                $().w2popup('close'); 
            },
            "cancel": function () { 
                this.clear();  
                $().w2popup('close'); 
            },
        }
    });
    $().w2popup('open', {
        title   : 'Create a new project',
        body    : '<div id="form" style="width: 100%; height: 100%;"></div>',
        style   : 'padding: 15px 0px 0px 0px',
        width   : 400, 
        height  : 200, 
        onOpen  : function () {
            $('#w2ui-popup #form').w2render('foo');
        }
    });
}


//editor 
initEditor();

testWebsockets();
list_apps("user");
list_apps("example");

get_documentation();




});

</script>
    
	
	

</head>



<body> 
<div id = "container">
<div id="toolbar" style="padding: 4px; border: 1px solid silver;"></div>
<div id="layout" style="width: 100%; height: 100%;">
</div>
<div id="grid" style="width: 100%; height: 350px;"></div>
</div>




<div id = "overlay"> 
    <div id = "toggle">Dashboard</div>

    <div id = "container">
        <div id = "device_status"> </div>
        <div id = "connection"><b>Connection Status</b></div> 

    </div>

</div>



</body>
</html>